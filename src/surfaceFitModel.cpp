#include "surfaceFitModel.hpp"

SurfaceFitModel::SurfaceFitModel() {

    p = MatrixXd::Zero(X_DEGREE + 1, Y_DEGREE + 1);

    p(0, 0) = -781536.384794701;
    p(1, 0) = 8623.59011973048;
    p(0, 1) = 643.65918253;
    p(2, 0) = -34.3646691281487;
    p(1, 1) = -5.46066535343611;
    p(0, 2) = -0.177121900557321;
    p(3, 0) = 0.0573287698655951;
    p(2, 1) = 0.0150031142038895;
    p(1, 2) = 0.00101871763126609;
    p(0, 3) = 1.63862900553892e-05;
    p(4, 0) = -3.21785828407871e-05;
    p(3, 1) = -1.3161091180883e-05;
    p(2, 2) = -1.42505256569339e-06;
    p(1, 3) = -4.76209793830867e-08;
}


double SurfaceFitModel::getFit(double x, double y) {

    return p(0, 0) + p(1, 0) * x + p(0, 1) * y + p(2, 0) * pow(x, 2) +
	p(1, 1) * x * y + p(0, 2) * pow(y, 2) + p(3, 0) * pow(x, 3) +
	p(2, 1) * pow(x, 2) * y + p(1, 2) * x * pow(y, 2) + p(0, 3) * pow(y, 3) +
	p(4, 0) * pow(x, 4) + p(3, 1) * pow(x, 3) * y + p(2, 2) * pow(x, 2) * pow(y, 2) +
	p(1, 3) * x * pow(y, 3); 
}









